# Product Requirements Document (PRD)
## Crypto-Stock Correlation Tracker

---

## 📋 Executive Summary

### Product Vision
創建一個以週為單位追蹤購買虛擬貨幣策略股票的分析平台，透過週一基準對比系統，幫助投資者分析股價與加密貨幣價格之間的因果關係和脫鉤現象。

### Business Objectives
- 提供股價-幣價相關性的即時追蹤分析
- 建立標準化的週一基準對比系統 (UTC+8 08:00)
- 識別股價與幣價的脫鉤和同步現象
- 為投資決策提供數據支撐和視覺化洞察

---

## 👥 Target Users

### Primary Users: 加密貨幣投資者
- **特徵**: 關注crypto-related股票的投資者
- **需求**: 了解股價與底層加密貨幣的相關性
- **使用場景**: 投資決策前的相關性分析

### Secondary Users: 量化分析師
- **特徵**: 專業的金融數據分析人員
- **需求**: 歷史數據回測和趨勢分析
- **使用場景**: 策略研發和風險評估

---

## 🎯 Core Problems Solved

### 1. 相關性分析困難
**問題**: 投資者難以直觀比較股價與加密貨幣的表現關係
**解決方案**: 統一的週一基準對比圖表系統

### 2. 脫鉤現象識別
**問題**: 無法快速識別股價與幣價的脫鉤時機
**解決方案**: 實時的漲跌幅對比和視覺化警示

### 3. 歷史數據缺失
**問題**: 缺乏標準化的歷史基準數據
**解決方案**: 自動化的歷史數據收集和回溯系統

---

## ⚙️ Functional Requirements

### 1. 核心數據追蹤功能

#### 1.1 股票-加密貨幣配對管理
- **必須支援的配對**:
  - MSTR (Strategy Inc.) ↔ BTC (Bitcoin)
  - SBET (SharpLink Gaming) ↔ ETH (Ethereum)
  - BNC (BNB Network Company) ↔ BNB (Binance Coin)
  - DFDV (DeFi Development Corp) ↔ SOL (Solana)
  - HYPD (Hyperion DeFi) ↔ HYPE (Hyperliquid)
  - VERB (VERB Technology) ↔ TON (Toncoin)

- **配對管理**:
  - 支援新配對的動態添加
  - 配對關係的編輯和刪除
  - 配對有效性驗證

#### 1.2 數據收集系統
- **股票數據**: Yahoo Finance API 整合
- **加密貨幣數據**: CoinGecko API 整合
- **更新頻率**: 實時價格 + 週五基準數據
- **數據驗證**: API 錯誤處理和數據完整性檢查

### 2. 週五基準對比系統

#### 2.1 基準時間定義
- **基準點**: 每週五 16:00 ET (美股收盤時間)
- **基準邏輯**: 以週五收盤價格作為週期基準點
- **週期格式**: 上週五 ~ 本週五 (例如：8/8 ~ 8/15)
- **比較方式**: 計算相對於基準點的百分比變化，分析週間滯後效應

#### 2.2 歷史數據管理
- **回溯期間**: 最少2個月歷史數據
- **數據結構**: 週為單位的基準價格記錄
- **數據補全**: 缺失數據的智能填補機制

### 3. 滯後效應分析功能

#### 3.1 滯後關係檢測
- **滯後分析**: 檢測股價與幣價的領先滯後關係
- **同步變動**: 識別股價與幣價的同步變化模式
- **週期比較**: 基於週五基準點的週間變化分析
- **趨勢識別**: 觀察價格變動的時間序列關係

---

## 🖥️ User Interface Requirements

### 1. 主要數據表格 (優化重點)
- **必須移除**: 持幣量、持幣價值欄位 (數據不準確)
- **核心欄位**:
  - 公司名稱 + 股票代號
  - 當前股價 + 股價變化%
  - 對應加密貨幣 + 幣價 + 幣價變化%
- **視覺化**: 漲跌顏色編碼

### 2. 滯後效應分析圖
- **圖表類型**: 多線圖 (Line Chart)
- **X軸**: 週期範圍 (例如：8/8 ~ 8/15)
- **Y軸**: 相對基準點變化百分比
- **線條設計**: 
  - 實線綠色: 股價變化 (例如：VERB 股價變化)
  - 虛線藍色: 幣價變化 (例如：TON 幣價變化)
  - 不同配對使用統一的線條樣式

### 3. 響應式設計
- **桌面**: 完整功能展示
- **行動裝置**: 核心功能保留，表格滾動優化
- **暗色主題**: 專業的財經界面風格

---

## 🔧 Technical Requirements

### 1. 前端技術棧
- **框架**: Next.js 15.4.5 (React)
- **樣式**: Tailwind CSS
- **圖表**: Recharts 圖表庫
- **語言**: TypeScript

### 2. 後端數據處理
- **ETL Pipeline**: Python 腳本
- **數據源**: Yahoo Finance + CoinGecko
- **存儲**: JSON 文件 (靜態部署)
- **錯誤處理**: API限制和網路錯誤的重試機制

### 3. 自動化部署
- **CI/CD**: GitHub Actions
- **觸發器**: 根據需要手動觸發或推送觸發
- **部署平台**: Vercel
- **版本控制**: Git 自動提交數據更新
- **增量數據管理**: 智能增量 ETL，避免重複 API 查詢

---

## 📊 Success Metrics

### 1. 數據品質指標
- **數據完整性**: >95% 成功數據收集率
- **數據真實性**: 100% 真實市場數據，避免虛假數據
- **更新及時性**: 週五基準數據準時更新率
- **API可靠性**: <5% API調用失敗率

### 2. 用戶體驗指標
- **載入速度**: 首頁載入時間 <3秒
- **圖表清晰度**: 滯後效應視覺化準確率
- **歷史數據覆蓋**: 完整的週五基準歷史數據

### 3. 功能使用指標
- **滯後效應分析**: 用戶能成功識別股價-幣價領先滯後關係
- **週期比較**: 基於週五基準的變化分析準確性
- **決策支援**: 用戶投資決策的數據支撐有效性

---

## 🚀 Release Plan

### Phase 1: 核心功能 (✅ 已完成)
- [x] 基礎股票-加密貨幣數據收集 (真實市場數據)
- [x] 週五基準對比系統
- [x] 主要數據表格優化
- [x] 滯後效應分析圖實現

### Phase 2: 數據增強 (✅ 已完成)
- [x] 移除不準確的持幣量數據
- [x] 股票代號驗證和修正 (使用真實市場數據)
- [x] 歷史數據回溯完善 (增量 ETL 系統)
- [x] 虛假數據問題解決 (VERB: $21 → $9.13)
- [ ] API錯誤處理優化

### Phase 3: 分析增強 (計劃中)
- [ ] 持幣量真實數據整合
- [ ] 市場佔有率分析 (公司持幣量/總供應量)
- [ ] 前十大持有公司排名
- [ ] 相關性統計指標

### Phase 4: 用戶體驗 (未來)
- [ ] 個人化投資組合追蹤
- [ ] 警示通知系統 (脫鉤警報)
- [ ] 移動端 App 開發
- [ ] 多語言支援

---

## 🔒 Risk Management

### 1. 技術風險
- **API限制**: CoinGecko免費版本的請求限制
- **數據準確性**: 第三方API數據的可靠性問題
- **服務中斷**: 外部API服務不可用的應急方案

### 2. 業務風險
- **法規變化**: 金融數據使用的法規限制
- **市場波動**: 極端市場條件下的數據異常
- **競品出現**: 類似功能產品的競爭壓力

### 3. 緩解方案
- **多數據源**: 備用API服務整合
- **緩存策略**: 離線數據備份機制
- **監控系統**: 自動化的系統健康檢查

---

## 📋 Acceptance Criteria

### 功能驗收標準

#### 1. 數據準確性
- [x] 所有股票代號對應正確的公司
- [x] 加密貨幣價格使用真實市場數據 (Yahoo Finance + CoinGecko)
- [x] 週五基準時間準確 (16:00 ET 美股收盤)

#### 2. 用戶界面
- [x] 主要數據表格已優化，移除不準確的持幣量數據
- [x] 滯後效應分析圖正確顯示實線綠色(股)虛線藍色(幣)
- [x] 週期格式正確顯示 (例如：8/8 ~ 8/15)

#### 3. 系統性能
- [x] 頁面載入時間優化
- [x] 增量 ETL pipeline 實現，避免重複 API 查詢
- [x] Vercel 自動化部署運行正常

#### 4. 數據覆蓋
- [x] 5週真實歷史基準數據完整 (7/18, 7/25, 8/1, 8/8, 8/15)
- [x] 所有配對的真實價格數據運行正常
- [x] 週五基準數據收集系統運行正常

---

*文件版本: v2.0*  
*最後更新: 2025-08-18*  
*作者: AI Assistant (Claude) + User Requirements*  
*更新內容: 符合當前週五基準系統實現，移除未實現功能描述*